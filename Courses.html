<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Courses</title>
  <link rel="icon" href="img/SK logo2.png" type="image/png">

  <!-- Boxicons -->
  <link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>

  <!-- Shared styles (Sidebar + Navbar) -->
  <link rel="stylesheet" href="Styles/shared.css">

  <!-- Page-specific styles -->
  <link rel="stylesheet" href="Styles/courses.css">
</head>

<body>
 <!-- SIDEBAR -->
	<section id="sidebar">

		<!--Logo part-->
		<a href="Home.html" class="brand">

			<img src="img/SK logo2.png" style="padding: 10px;  max-width: 30px;">
			<img class="logo" src="img/SK logo3.png">

		</a>

		<!-- menu items -->
		<ul class="side-menu top">
			<li>
				<a href="Home.html">
					<i class="bx bxs-home"> </i>
					<span class="text"> Home</span>
				</a>
			</li>
			
  <li>
    <a href="my_team.html">
      <i class="bx bxs-group"></i>
      <span class="text">My Department</span>
    </a>
  </li>
			<li>
				<a href="Excellent Works Manager.html">
					<i class='bx bx-star'></i>
					<span class="text"> Excellent Works</span>
				</a>
			</li>
			<li class="active">
				<a href="Courses.html">
					<i class="bx bx-certification"></i>
					<span class="text"> Course</span>
				</a>
			</li>
			<li>
				<a href="Vacation.html">
					<i class='bx bxs-plane-alt'></i>
					<span class="text"> Vacation</span>
				</a>
			</li>

			
		</ul>



		<!--log out part-->
		<ul class="side-menu">
			<li>
				<a href="login.html" class="logout">
					<i class='bx bxs-log-out-circle'></i>
					<span class="text">Logout</span>
				</a>
			</li>
		</ul>

	</section>
	<!-- SIDEBAR -->

  <!-- CONTENT -->
  <section id="content">
    <!-- NAVBAR -->
    <nav>
			<i class='bx bx-menu'></i>
			<div class="head-title">
				<div class="left">
					<h1>Excellent Works</h1>
				</div>
			</div>

			<a class="profile-link">
				<div class="nav-right">

					<!-- 1) Avatar + name -->
					<div class="profile" onclick="location.href='Profile.html'">
						<img src="img/proLama.jpg" alt="Profile">
						<div class="username">Lama
						</div>
					</div>


					<div class="points">
						<h2>95</h2>
						<p>Points</p>
					</div>


					<div class="notification-icon" onclick="location.href='Notification.html'">
						<i class='bx bxs-bell'></i>
						<span class="badge">3</span>
					</div>


				</div>
			</a>

		</nav>
    <!-- NAVBAR END -->

    <!-- MAIN -->
    <main>
      <div class="courses-container">
        <div class="search-filter-bar">
          <div class="search-bar">
            <i class='bx bx-search'></i>
            <input type="text" id="searchInput" placeholder="Search" />

          </div>

          <div class="custom-dropdown">
            <button id="filterBtn">
              <i class='bx bx-filter'></i>
              <span id="selectedFilter">All</span>
              <i class='bx bx-chevron-down'></i>
            </button>
            <ul class="dropdown-options">
              <li data-value="all">All</li>
              <li data-value="uiux">UI/UX</li>
              <li data-value="ai">AI</li>
              <li data-value="programming">Programming</li>
            </ul>
          </div>


          <button class="add-course-btn" onclick="openModal()">+ Add Course</button>
        </div>


        <div class="predefined-courses">
          <div class="courses-grid">
            <div class="course-card" data-category="uiux">
              <img src="img/cor1.png" alt="MIT B">
              <div class="course-info">
                <h3><i class='bx bx-book'></i> Advanced Certification in UI UX Design</h3>
                <p><i class='bx bx-star'></i> 30 Points</p>
                <p><i class='bx bx-time'></i> 5 Months</p>
                <p><i class='bx bx-group'></i> 3 Employees</p>

                <div class="card-buttons">
                  <button class="edit-btn">Edit</button>
                  <button class="delete-btn">Delete</button>
                </div>

              </div>
            </div>

            <div class="course-card" data-category="ai">
              <img src="img/cor2.png" alt="IxDF">
              <div class="course-info">
                <h3><i class='bx bx-book'></i> AI for Designers</h3>
                <p><i class='bx bx-star'></i> 10 Points</p>
                <p><i class='bx bx-time'></i> 13 Hours</p>
                <p><i class='bx bx-group'></i> 1 Employee</p>
                <div class="card-buttons">
                  <button class="edit-btn">Edit</button>
                  <button class="delete-btn">Delete</button>
                </div>

              </div>
            </div>

            <div class="course-card" data-category="ai">
              <img src="img/cor3.jpeg" alt="IxDF">
              <div class="course-info">
                <h3><i class='bx bx-book'></i> AI for Designers</h3>
                <p><i class='bx bx-star'></i> 10 Points</p>
                <p><i class='bx bx-time'></i> 13 Hours</p>
                <p><i class='bx bx-group'></i> 1 Employee</p>
                <div class="card-buttons">
                  <button class="edit-btn">Edit</button>
                  <button class="delete-btn">Delete</button>
                </div>
              </div>
            </div>

            <div class="course-card" data-category="uiux">
              <img src="img/cor3.jpeg" alt="google">
              <div class="course-info">
                <h3><i class='bx bx-book'></i> Foundations of User Experience Design</h3>
                <p><i class='bx bx-star'></i> 10 Points</p>
                <p><i class='bx bx-time'></i> 18 Months</p>
                <p><i class='bx bx-group'></i> 5 Employees</p>
                <div class="card-buttons">
                  <button class="edit-btn">Edit</button>
                  <button class="delete-btn">Delete</button>
                </div>


              </div>
            </div>

            <div class="course-card" data-category="programming">
              <img src="img/cor4.jpg" alt="Web Development">
              <div class="course-info">
                <h3><i class='bx bx-book'></i> Web Development Course</h3>
                <p><i class='bx bx-star'></i> 12 Points</p>
                <p><i class='bx bx-time'></i> 15 Hours</p>
                <p><i class='bx bx-group'></i> 4 Employees</p>
                <div class="card-buttons">
                  <button class="edit-btn">Edit</button>
                  <button class="delete-btn">Delete</button>
                </div>
              </div>
            </div>





          </div>

        </div>
        <!-- MAIN END -->
    </main>
  </section>

  <!-- courseModal-->
  <dialog id="courseModal" class="modal">
    <div class="modal-content" style="max-height: 80vh; overflow-y: auto;">
      <span class="close-btn" onclick="closeModal()">&times;</span>
      <h2>Select a Course to Add</h2>

      <div class="predefined-courses">

        <!-- كورس جاهز -->
        <div class="course-card">
          <img src="img/cor1.png" alt="Course">
          <div class="course-info">
            <h3>Intro to UI/UX</h3>
            <p><i class='bx bx-time'></i> 4 Weeks</p>

            <label class="points-label">
              <input type="number" class="points-input" min="1" placeholder="Points">
            </label>

            <button class="add-course-btn add-predefined-btn" data-name="Intro to UI/UX" data-duration="4 Weeks"
              data-category="uiux" data-link="https://www.coursera.org/learn/user-experience-design"
              data-img="img/cor1.png">
              Add
            </button>
          </div>
        </div>


        <!-- كورس ثاني -->
        <div class="course-card">
          <img src="img/cor2.png" alt="Course">
          <div class="course-info">
            <h3>AI for Designers</h3>
            <p><i class='bx bx-time'></i> 10 Hours</p>
            <label class="points-label">
              <input type="number" class="points-input" min="1" placeholder="Points">
            </label>

            <button class="add-course-btn add-predefined-btn" data-name="AI for Designers" data-duration="10 Hours"
              data-category="ai" data-link="https://www.interaction-design.org/courses/ai-for-designers"
              data-img="img/cor2.png">
              Add
            </button>
          </div>
        </div>

        <!-- كورس ثاني -->
        <div class="course-card">
          <img src="img/cor2.png" alt="Course">
          <div class="course-info">
            <h3>Design for Thought and Emotion</h3>
            <p><i class='bx bx-time'></i> 15 Hours</p>
            <label class="points-label">
              <input type="number" class="points-input" min="1" placeholder="Points">
            </label>

            <button class="add-course-btn add-predefined-btn" data-name="AI for Designers" data-duration="10 Hours"
              data-category="uiux" data-link="https://www.interaction-design.org/courses/ai-for-designers"
              data-img="img/cor2.png">
              Add
            </button>
          </div>
        </div>

        <!-- زر الإضافة اليدوية -->
        <div style="text-align: center; margin-top: 20px;">
          <button class="add-course-btn" onclick="openManualModal()">+ Add Custom Course</button>
        </div>



      </div>
    </div>
  </dialog>
  <!-- ✅ رسالة نجاح -->
  <div id="successMessage" class="message-bar success">
    Course added successfully!
  </div>
  <!-- ❌ رسالة حذف -->
  <div id="deleteMessage" class="message-bar error">
    Course deleted successfully!
  </div>


  <!-- Manual Course Modal -->
  <dialog id="manualModal" class="modal">
    <div class="modal-content manual-modal-content">
      <span class="close-btn" onclick="closeManualModal()">&times;</span>
      <h2>Add New Course</h2>
      <form id="manualForm" class="custom-form">
        <input type="text" id="manualCourseName" placeholder="Course Name" required />

        <div class="points-adjust">
          <input type="number" id="manualCoursePoints" value="10" readonly />
          <button type="button" onclick="adjustPoints(1)">+</button>
          <button type="button" onclick="adjustPoints(-1)">−</button>
        </div>

        <input type="text" id="manualCourseDuration" placeholder="Duration" required />

        <div class="custom-select">
          <select id="manualCourseCategory" required>
            <option value="" disabled selected>Select Category</option>
            <option value="uiux">UI/UX</option>
            <option value="ai">AI</option>
          </select>
        </div>

        <input type="url" id="manualCourseLink" placeholder="Course Link (https://example.com)" required />

        <div class="modal-actions">
          <button type="button" onclick="closeManualModal()">Cancel</button>
          <button type="submit">Add</button>
        </div>
      </form>
    </div>
  </dialog>



  <!-- Edit Course Modal -->
  <dialog id="editCourseModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeEditModal()">×</span>
      <h2>Edit Course</h2>
      <form id="editCourseForm">
        <input type="text" id="editCourseName" placeholder="Course Name" />
        <input type="number" id="editCoursePoints" placeholder="Points" />
        <input type="text" id="editCourseDuration" placeholder="Duration" />
        <div class="modal-actions">
          <button type="button" onclick="closeEditModal()">Cancel</button>
          <button type="submit" class="submit-btn">Apply Changes</button>
        </div>
      </form>
    </div>
  </dialog>

  <!-- confirmDeleteModa -->
  <dialog id="confirmDeleteModal" class="modal">
    <div class="modal-content">
      <h3>Are you sure you want to delete this course?</h3>
      <div class="modal-actions">
        <button id="cancelDelete" class="cancel-btn">Cancel</button>
        <button id="confirmDelete" class="submit-btn">Yes, Delete</button>
      </div>
    </div>
  </dialog>




  <!-- CONTENT END -->

  <!-- SCRIPTS -->


  <script src="script/script.js"></script>
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      // 1) دالة bindDeleteButtons(): تربط أزرار الحذف بالمودال الخاص بالتأكيد وتعرض رسالة بعد الحذف
      function bindDeleteButtons() {
        const confirmModal = document.getElementById("confirmDeleteModal");
        const btnCancel = document.getElementById("cancelDelete");
        const btnConfirm = document.getElementById("confirmDelete");
        let cardToDelete = null;

        // 1.a) ننظف أي event listeners قديمة على الأزرار
        document.querySelectorAll(".delete-btn").forEach(btn => {
          const clean = btn.cloneNode(true);
          btn.replaceWith(clean);
        });

        // 1.b) نربط حدث فتح المودال بالتأكد لكل زر Delete
        document.querySelectorAll(".delete-btn").forEach(btn => {
          btn.addEventListener("click", () => {
            cardToDelete = btn.closest(".course-card");
            confirmModal.showModal();
          });
        });

        // 1.c) زر الإلغاء: يغلق المودال بدون حذف
        btnCancel.addEventListener("click", () => {
          cardToDelete = null;
          confirmModal.close();
        });

        // 1.d) زر التأكيد: يحذف الكارد ويعرض رسالة نجاح
        btnConfirm.addEventListener("click", () => {
          if (cardToDelete) {
            cardToDelete.remove();
            const msg = document.getElementById("deleteMessage");
            msg.classList.add("show");
            setTimeout(() => msg.classList.remove("show"), 3000);
          }
          confirmModal.close();
        });
      }

      // 2) دالة bindEditButtons(): تربط أزرار التعديل بفتح مودال التعديل مع تعبئة الحقول
      function bindEditButtons() {
        // 2.a) ننظف أي listeners قديمة
        document.querySelectorAll(".edit-btn").forEach(btn => {
          const clean = btn.cloneNode(true);
          btn.replaceWith(clean);
        });

        // 2.b) نربط لكل زر Edit حدث فتح المودال وتعبئة الاسم والنقاط والمدة
        document.querySelectorAll(".edit-btn").forEach(btn => {
          btn.addEventListener("click", () => {
            const card = btn.closest(".course-card");
            const name = card.querySelector("h3").textContent.trim();
            const points = card.querySelector("p:nth-of-type(1)").textContent.replace(/\D/g, '');
            const duration = card.querySelector("p:nth-of-type(2)").textContent.replace(/^[^\d]*(.*)$/, '$1');
            openEditModal(name, points, duration);
          });
        });
      }

      // 3) نشغّل الربط للأزرار الثابتة عند بدء الصفحة
      bindDeleteButtons();
      bindEditButtons();

      // ========== باقي الكود: فلترة + مودالات + إضافة كارد ==========
      const addModal = document.getElementById("courseModal");
      const manualModal = document.getElementById("manualModal");
      const editModal = document.getElementById("editCourseModal");
      const editForm = document.getElementById("editCourseForm");

      // 4) فلترة الكروسات حسب الفئة أو نص البحث
      const filterBtn = document.getElementById("filterBtn");
      const dropdown = document.querySelector(".dropdown-options");
      const selectedTxt = document.getElementById("selectedFilter");
      const searchInput = document.getElementById("searchInput");

      // 4.a) فتح/إغلاق القائمة
      filterBtn.addEventListener("click", () => {
        dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
      });

      // 4.b) اختيار فئة ويظهر الكروسات المطابقة
      dropdown.querySelectorAll("li").forEach(item => {
        item.addEventListener("click", () => {
          const sel = item.dataset.value;
          selectedTxt.textContent = item.textContent;
          dropdown.style.display = "none";
          document.querySelectorAll(".course-card").forEach(card => {
            const cat = card.getAttribute("data-category");
            card.style.display = (sel === "all" || cat === sel) ? "flex" : "none";
          });
        });
      });

      // 4.c) البحث بالنص ويظهر الكروسات التي تحتوي العنوان عليه
      searchInput?.addEventListener("input", () => {
        const txt = searchInput.value.toLowerCase();
        document.querySelectorAll(".course-card").forEach(card => {
          const title = card.querySelector("h3").textContent.toLowerCase();
          card.style.display = title.includes(txt) ? "flex" : "none";
        });
      });

      // 5) مودالات الإضافة والتعديل
      window.openModal = () => { addModal.showModal(); bindAddPredefinedCourses(); };
      window.closeModal = () => addModal.close();
      window.openManualModal = () => manualModal.showModal();
      window.closeManualModal = () => manualModal.close();
      window.openEditModal = (n, p, d) => {
        document.getElementById("editCourseName").value = n;
        document.getElementById("editCoursePoints").value = p;
        document.getElementById("editCourseDuration").value = d;
        editModal.showModal();
      };
      window.closeEditModal = () => editModal.close();
      editForm.addEventListener("submit", e => {
        e.preventDefault();
        closeEditModal();
      });

      // 6) إضافة كورسات جاهزة: تحقق من النقاط ثم استدعاء addCourse
      function bindAddPredefinedCourses() {
        document.querySelectorAll(".add-predefined-btn").forEach(btn => {
          btn.addEventListener("click", () => {
            const card = btn.closest(".course-card");
            const pts = card.querySelector(".points-input").value.trim();
            if (!pts || isNaN(pts) || +pts <= 0) {
              card.querySelector(".points-input").classList.add("error-input");
              card.querySelector(".points-input").focus();
              return;
            }
            card.querySelector(".points-input").classList.remove("error-input");
            addCourse(
              btn.dataset.name,
              btn.dataset.duration,
              btn.dataset.category,
              btn.dataset.link,
              btn.dataset.img,
              pts
            );
          });
        });
      }

      // 7) دالة addCourse(): تبني كارد جديد، تضيفه، ثم تربط أزرار الحذف والتعديل عليه
      window.addCourse = function (name, duration, category, link, img, points) {
        const grid = document.querySelector(".courses-grid");
        const card = document.createElement("div");
        card.className = "course-card";
        card.setAttribute("data-category", category);
        card.innerHTML = `
      <img src="${img}" style="width:70px;height:70px;object-fit:contain">
      <div class="course-info">
        <h3><i class='bx bx-book'></i> ${name}</h3>
        <p><i class='bx bx-star'></i> ${points} Points</p>
        <p><i class='bx bx-time'></i> ${duration}</p>
        <div class="card-buttons">
          <button class="edit-btn">Edit</button>
          <button class="delete-btn">Delete</button>
        </div>
      </div>
    `;
        grid.appendChild(card);

        // 7.a) اربط الأزرار على الكارد الجديد
        bindDeleteButtons();
        bindEditButtons();

        // 7.b) رسالة نجاح ثم إغلاق المودال
        const msg = document.getElementById("successMessage");
        msg.classList.add("show");
        setTimeout(() => msg.classList.remove("show"), 3000);
        closeModal();
      };
    });


  </script>

</body>

</html>